{"version":3,"sources":["index.cjs.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar axios = require('axios');\nvar EventEmitter = require('eventemitter3');\n\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\n\nvar axios__default = /*#__PURE__*/_interopDefaultLegacy(axios);\nvar EventEmitter__default = /*#__PURE__*/_interopDefaultLegacy(EventEmitter);\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nfunction __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nfunction __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\n\nvar request$1 = function (_a) {\r\n    var _b = _a.method, method = _b === void 0 ? 'POST' : _b, url = _a.url, data = _a.data, headers = _a.headers;\r\n    return __awaiter(void 0, void 0, void 0, function () {\r\n        var res, err_1;\r\n        return __generator(this, function (_c) {\r\n            switch (_c.label) {\r\n                case 0:\r\n                    _c.trys.push([0, 2, , 3]);\r\n                    return [4 /*yield*/, axios__default[\"default\"]({\r\n                            method: method,\r\n                            url: url,\r\n                            data: data,\r\n                            headers: headers,\r\n                        })];\r\n                case 1:\r\n                    res = _c.sent();\r\n                    if (res.data.code !== 200) {\r\n                        return [2 /*return*/, Promise.reject(res.data)];\r\n                    }\r\n                    return [2 /*return*/, res.data];\r\n                case 2:\r\n                    err_1 = _c.sent();\r\n                    return [2 /*return*/, Promise.reject(err_1)];\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n};\r\nvar webRequestHelper = request$1;\n\nvar request = webRequestHelper;\n\nvar Storage = /** @class */ (function () {\r\n    function Storage(type, salt) {\r\n        this.store = new Map();\r\n        this.type = 'memory';\r\n        this.salt = '__salt__';\r\n        type && (this.type = type);\r\n        salt && (this.salt = salt);\r\n    }\r\n    Storage.prototype.get = function (key) {\r\n        var value;\r\n        switch (this.type) {\r\n            case 'memory':\r\n                return this.store.get(key);\r\n            case 'localStorage':\r\n                value = localStorage.getItem(\"\".concat(this.salt).concat(key));\r\n                if (value) {\r\n                    return JSON.parse(value);\r\n                }\r\n                return value;\r\n            case 'sessionStorage':\r\n                value = sessionStorage.getItem(\"\".concat(this.salt).concat(key));\r\n                if (value) {\r\n                    return JSON.parse(value);\r\n                }\r\n                return value;\r\n        }\r\n    };\r\n    Storage.prototype.set = function (key, value) {\r\n        switch (this.type) {\r\n            case 'memory':\r\n                this.store.set(key, value);\r\n                break;\r\n            case 'localStorage':\r\n                localStorage.setItem(\"\".concat(this.salt).concat(key), JSON.stringify(value));\r\n                break;\r\n            case 'sessionStorage':\r\n                sessionStorage.setItem(\"\".concat(this.salt).concat(key), JSON.stringify(value));\r\n                break;\r\n        }\r\n    };\r\n    Storage.prototype.remove = function (key) {\r\n        switch (this.type) {\r\n            case 'memory':\r\n                this.store.delete(key);\r\n                break;\r\n            case 'localStorage':\r\n                localStorage.removeItem(\"\".concat(this.salt).concat(key));\r\n                break;\r\n            case 'sessionStorage':\r\n                sessionStorage.removeItem(\"\".concat(this.salt).concat(key));\r\n                break;\r\n        }\r\n    };\r\n    return Storage;\r\n}());\r\nvar webStorage = Storage;\n\nvar index = webStorage;\n\nvar url = \"https://statistic.live.126.net/statics/report/xkit/action\";\r\nvar EventTracking = /** @class */ (function () {\r\n    function EventTracking(_a) {\r\n        var appKey = _a.appKey, version = _a.version, component = _a.component, nertcVersion = _a.nertcVersion, imVersion = _a.imVersion, _b = _a.platform, platform = _b === void 0 ? 'Web' : _b;\r\n        this.platform = platform;\r\n        this.appKey = appKey;\r\n        this.version = version;\r\n        this.component = component;\r\n        this.nertcVersion = nertcVersion;\r\n        this.imVersion = imVersion;\r\n    }\r\n    EventTracking.prototype.track = function (reportType, data) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a, appKey, version, component, nertcVersion, imVersion, platform, timeStamp;\r\n            return __generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        _a = this, appKey = _a.appKey, version = _a.version, component = _a.component, nertcVersion = _a.nertcVersion, imVersion = _a.imVersion, platform = _a.platform;\r\n                        timeStamp = Date.now();\r\n                        _c.label = 1;\r\n                    case 1:\r\n                        _c.trys.push([1, 3, , 4]);\r\n                        return [4 /*yield*/, request({\r\n                                method: 'POST',\r\n                                url: url,\r\n                                data: {\r\n                                    appKey: appKey,\r\n                                    version: version,\r\n                                    component: component,\r\n                                    timeStamp: timeStamp,\r\n                                    nertcVersion: nertcVersion,\r\n                                    imVersion: imVersion,\r\n                                    platform: platform,\r\n                                    reportType: reportType,\r\n                                    data: data,\r\n                                },\r\n                            })];\r\n                    case 2:\r\n                        _c.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        _c.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 4: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return EventTracking;\r\n}());\r\nvar EventTracking$1 = EventTracking;\n\n/**\r\n * 判断元素是否可见\r\n * 融合了 IntersectionObserver 与 visibilityChange 事件\r\n */\r\nvar VisibilityObserver = /** @class */ (function (_super) {\r\n    __extends(VisibilityObserver, _super);\r\n    // 入参说明参考：https://developer.mozilla.org/zh-CN/docs/Web/API/Intersection_Observer_API\r\n    function VisibilityObserver(options) {\r\n        var _this = _super.call(this) || this;\r\n        _this.visibilityState = document.visibilityState;\r\n        _this.entries = [];\r\n        _this._visibilitychange = function () {\r\n            _this.visibilityState = document.visibilityState;\r\n            _this._trigger();\r\n        };\r\n        _this.intersectionObserver = new IntersectionObserver(_this._intersectionObserverHandler.bind(_this), options);\r\n        document.addEventListener('visibilitychange', _this._visibilitychange);\r\n        return _this;\r\n    }\r\n    VisibilityObserver.prototype.observe = function (target) {\r\n        return this.intersectionObserver.observe(target);\r\n    };\r\n    VisibilityObserver.prototype.unobserve = function (target) {\r\n        return this.intersectionObserver.unobserve(target);\r\n    };\r\n    VisibilityObserver.prototype.destroy = function () {\r\n        this.intersectionObserver.disconnect();\r\n        document.removeEventListener('visibilitychange', this._visibilitychange);\r\n        this.entries = [];\r\n    };\r\n    VisibilityObserver.prototype._intersectionObserverHandler = function (entries, observer) {\r\n        this.entries = entries;\r\n        this._trigger();\r\n    };\r\n    VisibilityObserver.prototype._trigger = function () {\r\n        var _this = this;\r\n        this.entries.forEach(function (item) {\r\n            if (_this.visibilityState !== 'visible' || item.intersectionRatio <= 0) {\r\n                _this.emit('visibleChange', {\r\n                    visible: false,\r\n                    target: item.target,\r\n                });\r\n                return;\r\n            }\r\n            _this.emit('visibleChange', {\r\n                visible: true,\r\n                target: item.target,\r\n            });\r\n        });\r\n    };\r\n    return VisibilityObserver;\r\n}(EventEmitter__default[\"default\"]));\r\nvar VisibilityObserver$1 = VisibilityObserver;\n\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar loglevel = createCommonjsModule(function (module) {\n/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    if (module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(commonjsGlobal, function () {\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n    var isIE = (typeof window !== undefinedType) && (typeof window.navigator !== undefinedType) && (\n        /Trident\\/|MSIE /.test(window.navigator.userAgent)\n    );\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Trace() doesn't print the message in IE, so for that case we need to wrap it\n    function traceForIE() {\n        if (console.log) {\n            if (console.log.apply) {\n                console.log.apply(console, arguments);\n            } else {\n                // In old IE, native console methods themselves don't have apply().\n                Function.prototype.apply.apply(console.log, [console, arguments]);\n            }\n        }\n        if (console.trace) console.trace();\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === 'debug') {\n            methodName = 'log';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (methodName === 'trace' && isIE) {\n            return traceForIE;\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods(level, loggerName) {\n        /*jshint validthis:true */\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, loggerName);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n    }\n\n    // In old IE versions, the console isn't present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName, level, loggerName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this, level, loggerName);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, level, loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, defaultLevel, factory) {\n      var self = this;\n      var currentLevel;\n      defaultLevel = defaultLevel == null ? \"WARN\" : defaultLevel;\n\n      var storageKey = \"loglevel\";\n      if (typeof name === \"string\") {\n        storageKey += \":\" + name;\n      } else if (typeof name === \"symbol\") {\n        storageKey = undefined;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var location = cookie.indexOf(\n                      encodeURIComponent(storageKey) + \"=\");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(cookie.slice(location))[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      function clearPersistedLevel() {\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage.removeItem(storageKey);\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=; expires=Thu, 01 Jan 1970 00:00:00 UTC\";\n          } catch (ignore) {}\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          return currentLevel;\n      };\n\n      self.setLevel = function (level, persist) {\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              currentLevel = level;\n              if (persist !== false) {  // defaults to true\n                  persistLevelIfPossible(level);\n              }\n              replaceLoggingMethods.call(self, level, name);\n              if (typeof console === undefinedType && level < self.levels.SILENT) {\n                  return \"No console available for logging\";\n              }\n          } else {\n              throw \"log.setLevel() called with invalid level: \" + level;\n          }\n      };\n\n      self.setDefaultLevel = function (level) {\n          defaultLevel = level;\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.resetLevel = function () {\n          self.setLevel(defaultLevel, false);\n          clearPersistedLevel();\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      // Initialize with the right level\n      var initialLevel = getPersistedLevel();\n      if (initialLevel == null) {\n          initialLevel = defaultLevel;\n      }\n      self.setLevel(initialLevel, false);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    var defaultLogger = new Logger();\n\n    var _loggersByName = {};\n    defaultLogger.getLogger = function getLogger(name) {\n        if ((typeof name !== \"symbol\" && typeof name !== \"string\") || name === \"\") {\n          throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n          logger = _loggersByName[name] = new Logger(\n            name, defaultLogger.getLevel(), defaultLogger.methodFactory);\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    // ES6 default export, for compatibility\n    defaultLogger['default'] = defaultLogger;\n\n    return defaultLogger;\n}));\n});\n\nvar log = loglevel;\n\nfunction createLoggerDecorator(MODULE_NAME, logger) {\r\n    return function (__, propKey, descriptor) {\r\n        var method = descriptor.value;\r\n        descriptor.value = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var methodName, res, err_1;\r\n                return __generator(this, function (_a) {\r\n                    switch (_a.label) {\r\n                        case 0:\r\n                            if (!logger) {\r\n                                // @ts-ignore\r\n                                logger = this.logger;\r\n                            }\r\n                            if (['log', 'error'].some(function (item) { return !logger[item]; })) {\r\n                                console.warn('loggerDecorator warning: your logger is not complete');\r\n                            }\r\n                            methodName = method.name || propKey || '';\r\n                            _a.label = 1;\r\n                        case 1:\r\n                            _a.trys.push([1, 3, , 4]);\r\n                            logger === null || logger === void 0 ? void 0 : logger.log.apply(logger, __spreadArray([MODULE_NAME, methodName], __read(args), false));\r\n                            return [4 /*yield*/, method.apply(this, args)];\r\n                        case 2:\r\n                            res = _a.sent();\r\n                            logger === null || logger === void 0 ? void 0 : logger.log(MODULE_NAME, \"\".concat(methodName, \" success: \"), res);\r\n                            return [2 /*return*/, res];\r\n                        case 3:\r\n                            err_1 = _a.sent();\r\n                            logger === null || logger === void 0 ? void 0 : logger.error(MODULE_NAME, \"\".concat(methodName, \" failed: \"), err_1);\r\n                            throw err_1;\r\n                        case 4: return [2 /*return*/];\r\n                    }\r\n                });\r\n            });\r\n        };\r\n    };\r\n}\n\nfunction sensitiveInfoFilter(content) {\r\n    var regexs = [\r\n        'scene/apps/[a-z0-9]{32}/',\r\n        '\"rtcKey\":\"[a-z0-9]{32}\"',\r\n        '\"imKey\":\"[a-z0-9]{32}\"',\r\n        '\"appkey\":\"[a-z0-9]{32}\"',\r\n        '\"appkey\": \"[a-z0-9]{32}\"',\r\n        'appkey:\"[a-z0-9]{32}\"',\r\n        'appkey: \"[a-z0-9]{32}\"',\r\n        '\"appkey\":[a-z0-9]{32}',\r\n        '\"appkey\": [a-z0-9]{32}',\r\n        'appkey:[a-z0-9]{32}',\r\n        'appkey: [a-z0-9]{32}',\r\n    ];\r\n    var templates = [\r\n        'scene/apps/***/',\r\n        '\"rtcKey\":\"***\"',\r\n        '\"imKey\":\"***\"',\r\n        '\"appkey\":\"***\"',\r\n        '\"appkey\": \"***\"',\r\n        'appkey:\"***\"',\r\n        'appkey: \"***\"',\r\n        '\"appkey\":***',\r\n        '\"appkey\": ***',\r\n        'appkey:***',\r\n        'appkey: ***',\r\n    ];\r\n    regexs.forEach(function (regex, index) {\r\n        var reg = new RegExp(regex, 'gi');\r\n        content = content.replace(reg, templates[index]);\r\n    });\r\n    return content;\r\n}\r\nvar logDebug = function (_a) {\r\n    var _b = _a === void 0 ? {\r\n        appName: '',\r\n        version: '',\r\n        storeWindow: false,\r\n    } : _a, level = _b.level, _c = _b.appName, appName = _c === void 0 ? '' : _c; _b.version; var _e = _b.storeWindow, storeWindow = _e === void 0 ? false : _e;\r\n    var genTime = function () {\r\n        var now = new Date();\r\n        var year = now.getFullYear();\r\n        var month = now.getMonth() + 1;\r\n        var day = now.getDate();\r\n        var hour = now.getHours() < 10 ? \"0\".concat(now.getHours()) : now.getHours();\r\n        var min = now.getMinutes() < 10 ? \"0\".concat(now.getMinutes()) : now.getMinutes();\r\n        var s = now.getSeconds() < 10 ? \"0\".concat(now.getSeconds()) : now.getSeconds();\r\n        var nowString = \"\".concat(year, \"-\").concat(month, \"-\").concat(day, \" \").concat(hour, \":\").concat(min, \":\").concat(s);\r\n        return nowString;\r\n    };\r\n    var genUserAgent = function () {\r\n        try {\r\n            var ua = navigator.userAgent.toLocaleLowerCase();\r\n            var re = /(msie|firefox|chrome|opera|version).*?([\\d.]+)/;\r\n            var m = ua.match(re) || [];\r\n            var browser = m[1].replace(/version/, 'safari');\r\n            var ver = m[2];\r\n            return {\r\n                browser: browser,\r\n                ver: ver,\r\n            };\r\n        }\r\n        catch (error) {\r\n            return null;\r\n        }\r\n    };\r\n    var proxyLog = function () {\r\n        var _log = new Proxy(log, {\r\n            get: function (target, prop) {\r\n                var _a, _b;\r\n                if (!(prop in target)) {\r\n                    return;\r\n                }\r\n                var func = target[prop];\r\n                if (!['log', 'info', 'warn', 'error', 'trace', 'debug'].includes(prop)) {\r\n                    return func;\r\n                }\r\n                var prefix = genTime();\r\n                if (genUserAgent()) {\r\n                    prefix += \"[\".concat((_a = genUserAgent()) === null || _a === void 0 ? void 0 : _a.browser, \" \").concat((_b = genUserAgent()) === null || _b === void 0 ? void 0 : _b.ver, \"]\");\r\n                }\r\n                prefix +=\r\n                    \"[\".concat({\r\n                        log: 'L',\r\n                        info: 'I',\r\n                        warn: 'W',\r\n                        error: 'E',\r\n                        trace: 'E',\r\n                        debug: 'D',\r\n                    }[prop], \"]\") +\r\n                        \"[\".concat(appName, \"]\") +\r\n                        ':';\r\n                // eslint-disable-next-line @typescript-eslint/no-this-alias\r\n                var that = this;\r\n                return function () {\r\n                    var args = [];\r\n                    for (var _i = 0; _i < arguments.length; _i++) {\r\n                        args[_i] = arguments[_i];\r\n                    }\r\n                    for (var i = 0; i < args.length; i++) {\r\n                        if (typeof args[i] === 'object') {\r\n                            try {\r\n                                args[i] = JSON.stringify(args[i]);\r\n                            }\r\n                            catch (_a) {\r\n                                console.warn('[日志打印对象无法序列化]', args[i]);\r\n                                args[i] = args[i];\r\n                            }\r\n                        }\r\n                        if (typeof args[i] === 'string') {\r\n                            args[i] = sensitiveInfoFilter(args[i]);\r\n                        }\r\n                    }\r\n                    return func.apply(that, __spreadArray([prefix], __read(args), false));\r\n                };\r\n            },\r\n        });\r\n        return _log;\r\n    };\r\n    var logger = proxyLog();\r\n    if (level) {\r\n        logger.setLevel(level);\r\n    }\r\n    if (storeWindow) {\r\n        // @ts-ignore\r\n        window.__LOGGER__ = logger;\r\n    }\r\n    return logger;\r\n};\r\nvar logDebug$1 = logDebug;\n\n/**\r\n * 异步频率控制\r\n * 一段时间内只请求一次，多余的用这一次执行的结果做为结果\r\n * @param fn\r\n * @param delay\r\n */\r\nvar frequencyControl = function (fn, delay) {\r\n    var queue = [];\r\n    var last = 0;\r\n    var timer;\r\n    return function () {\r\n        var _this = this;\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        return new Promise(function (resolve, reject) {\r\n            queue.push({ resolve: resolve, reject: reject });\r\n            var cur = Date.now();\r\n            var consumer = function (success, res) {\r\n                while (queue.length) {\r\n                    var _a = queue.shift(), resolve_1 = _a.resolve, reject_1 = _a.reject;\r\n                    success ? resolve_1(res) : reject_1(res);\r\n                }\r\n            };\r\n            var excute = function () {\r\n                last = cur;\r\n                if (!queue.length)\r\n                    return;\r\n                // @ts-ignore\r\n                fn.apply(_this, args).then(function (res) {\r\n                    consumer(true, res);\r\n                }, function (err) {\r\n                    consumer(false, err);\r\n                });\r\n            };\r\n            if (cur - last > delay) {\r\n                excute();\r\n            }\r\n            else {\r\n                clearTimeout(timer);\r\n                timer = setTimeout(function () {\r\n                    excute();\r\n                }, delay);\r\n            }\r\n        });\r\n    };\r\n};\r\nfunction getFileType(filename) {\r\n    var fileMap = {\r\n        img: /(png|gif|jpg)/i,\r\n        pdf: /pdf$/i,\r\n        word: /(doc|docx)$/i,\r\n        excel: /(xls|xlsx)$/i,\r\n        ppt: /(ppt|pptx)$/i,\r\n        zip: /(zip|rar|7z)$/i,\r\n        audio: /(mp3|wav|wmv)$/i,\r\n        video: /(mp4|mkv|rmvb|wmv|avi|flv|mov)$/i,\r\n    };\r\n    return Object.keys(fileMap).find(function (type) { return fileMap[type].test(filename); }) || '';\r\n}\r\n/**\r\n * 解析输入的文件大小\r\n * @param size 文件大小，单位b\r\n * @param level 递归等级，对应fileSizeMap\r\n */\r\nvar parseFileSize = function (size, level) {\r\n    if (level === void 0) { level = 0; }\r\n    var fileSizeMap = {\r\n        0: 'B',\r\n        1: 'KB',\r\n        2: 'MB',\r\n        3: 'GB',\r\n        4: 'TB',\r\n    };\r\n    var handler = function (size, level) {\r\n        if (level >= Object.keys(fileSizeMap).length) {\r\n            return 'the file is too big';\r\n        }\r\n        if (size < 1024) {\r\n            return \"\".concat(size).concat(fileSizeMap[level]);\r\n        }\r\n        return handler(Math.round(size / 1024), level + 1);\r\n    };\r\n    return handler(size, level);\r\n};\r\nvar addUrlSearch = function (url, search) {\r\n    var urlObj = new URL(url);\r\n    urlObj.search += (urlObj.search.startsWith('?') ? '&' : '?') + search;\r\n    return urlObj.href;\r\n};\r\nfunction debounce(fn, wait) {\r\n    var timer = null;\r\n    return function () {\r\n        var _this = this;\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        if (timer) {\r\n            clearTimeout(timer);\r\n            timer = null;\r\n        }\r\n        timer = setTimeout(function () {\r\n            // @ts-ignore\r\n            fn.apply(_this, args);\r\n        }, wait);\r\n    };\r\n}\n\nexports.EventTracking = EventTracking$1;\nexports.Storage = index;\nexports.VisibilityObserver = VisibilityObserver$1;\nexports.addUrlSearch = addUrlSearch;\nexports.createLoggerDecorator = createLoggerDecorator;\nexports.debounce = debounce;\nexports.frequencyControl = frequencyControl;\nexports.getFileType = getFileType;\nexports.logDebug = logDebug$1;\nexports.parseFileSize = parseFileSize;\nexports.request = request;\n"]}